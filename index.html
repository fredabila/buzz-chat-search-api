<!DOCTYPE html>
<html>
<head>
	<title>Search People</title>
	<style>
		table {
			border-collapse: collapse;
			width: 100%;
		}

		th, td {
			text-align: left;
			padding: 8px;
			border-bottom: 1px solid #ddd;
		}

		th {
			background-color: #04AA6D;
			color: white;
		}
	</style>
</head>
<body>
	<h1>Search People</h1>
	<form id="search-form">
		<label for="query">Search keywords:</label>
		<input type="text" id="query" name="query" required>

		<label for="offset">Last post offset ID:</label>
		<input type="text" id="offset" name="offset">

		<label for="session_id">Access token ID:</label>
		<input type="text" id="session_id" name="session_id">

		<label for="page_size">Total post limit for each request:</label>
		<input type="text" id="page_size" name="page_size" value="20" required>

		<button type="submit">Search</button>
	</form>

	<table id="results"></table>

	<script>
		const form = document.querySelector('#search-form');
		const resultsTable = document.querySelector('#results');

		form.addEventListener('submit', async (event) => {
			event.preventDefault();

			const formData = new FormData(form);
			const url = 'https://buzzchat.site/mobile_api/search_people';
			const queryParams = new URLSearchParams(formData).toString();

			try {
				const response = await fetch(`${url}?${queryParams}`);
				const data = await response.json();

				// Clear previous results
				resultsTable.innerHTML = '';

				// Create header row
				const headerRow = document.createElement('tr');
				const nameHeader = document.createElement('th');
				nameHeader.textContent = 'Name';
				const emailHeader = document.createElement('th');
				emailHeader.textContent = 'Email';
				headerRow.appendChild(nameHeader);
				headerRow.appendChild(emailHeader);
				resultsTable.appendChild(headerRow);

				// Create result rows
				data.data.forEach((person) => {
					const row = document.createElement('tr');
					const nameCell = document.createElement('td');
					nameCell.textContent = person.name;
					const emailCell = document.createElement('td');
					emailCell.textContent = person.email;
					row.appendChild(nameCell);
					row.appendChild(emailCell);
					resultsTable.appendChild(row);
				});
			} catch (error) {
				console.error(error);
				alert('An error occurred while fetching results. Please try again later.');
			}
		});
	</script>
</body>
</html>
